\chapter{Lecture 5 - Non-homogeneous Linear Equations with Constant Coefficients}
\label{ch:lec5}
\section{Objectives}
The objectives of this lecture are:
\begin{itemize}
\item Describe the Method of Undetermined Coefficients for solving non-homogeneous linear equations with constant coefficients.
\item Carry out some examples to illustrate the methods.
\end{itemize}

\section{Background}
In this lecture we will review \emph{a} method for finding solutions to non-homogeneous linear equations with constant coefficients.\marginnote{To be perfectly honest, we spend very little time in this class dealing with non-homogeneous equations of any kind.  Many of those types of equations are beyond our ability to solve analytically so we turn to numerical methods instead. Nonetheless there is value in reminding ourselves how to construct solutions for those cases where we can.}

\newthought{Consider the equation} 
\begin{equation}
a_nu^{(n)} + a_{n-1}u^{(n-1)}+\cdots+a_1u^{\prime}+a_0u = g(x)
\label{eq:cc_nonhomo}
\end{equation}
where
\begin{itemize}
\item the coefficients $a_i, \ i\in [1,2,\dots,n]$ are constants; and
\item the function $g(x)$ is a constant, a polynomial function, exponential function, sine or cosine, or finite sums or products of these functions.
\end{itemize}
The general solution, $u(x)$, can be constructed as $u_c(x)+u_p(x)$ where:
\begin{itemize}
\item $u_c(x)$ is the complementary solution which, as you should recall, is the general solution to the associated homogeneous problem. [i.e. Equation \ref{eq:cc_nonhomo} with $g(x)=0$]; and
\item $u_p(x)$ is (any) particular solution---that is, a not-necessarily-unique function that satisfies Equation \ref{eq:cc_nonhomo}.
\end{itemize}
We spent the last lecture describing how to find $u_c(x)$.  The question this lecture will hope to answer is: ``How do I find $u_p(x)$?''  
\section{Method of Undetermined Coefficients}\index{Undetermined Coefficients}
One method for finding $u_p(x)$ is called the Method of Undetermined Coefficients.\sidenote{Some people lovingly refer to this technique as "The Method of Guessing."}

\newthought{There are three} parts to this technique

\begin{enumerate}
\item \textbf{Basic Rule:} based on the terms in $g(x)$, select the appropriate form for $u_p(x)$ using Table \ref{tab:method-of-guessing-table}.

\begin{table}[h]
\begin{center}
\begin{tabular}{|c|l|}
%\toprule
\hline
Term in $g(x)$ & Choice for $u_p(x)$ \\\hline%\midrule

$ke^{\gamma x}$ & $Ae^{\gamma x}$ \\\hline
$kx^{n}, \ (n=0,1,\dots)$ & $K_nx^n+K_{n-1}x^{n-1}+\cdots +K_1x+K_0$\\\hline
$k \cos{\omega x}$ & \multirow{2}{*}{$\Big\} \ K\cos{\omega x} + M\sin{\omega x}$}\\\cline{1-1}
$k \sin{\omega x}$ &                 \\\hline
$ke^{\alpha x}\cos{\omega x}$   & \multirow{2}{*}{$\Big\} \ e^{\alpha x}\left(K\cos{\omega x} + M\sin{\omega x}\right)$}\\\cline{1-1} 
$ke^{\alpha x}\sin{\omega x}$ &      \\\hline
%\bottomrule
\end{tabular}
\end{center}
\caption{Forms of $u_p(x)$ for given terms in $g(x)$}
\label{tab:method-of-guessing-table}
\end{table}

\item \textbf{Modification rule:} if $u_p(x)$ obtained by the \textbf{Basic Rule} happens to be a solution to the associated homogeneous equation, multiply $u_p(x)$ from the table by $x$ (or $x^2$ if needed).

\item \textbf{Sum rule:} if $g(x)$ is a linear combination of terms from the left-hand column, construct $u_p(x)$ from a linear combination of the corresponding entries in the right-hand column.
\end{enumerate}
For the remainder of this lecture, we will practice applying these rules to some example problems.

\vspace{0.5cm}

\noindent{\textbf{Example:}} Solve $u^{\prime \prime}+4u^{\prime}-2u = 2x^2 - 3x + 6$.

\vspace{0.25cm}
\noindent{\textbf{Step \#1:}} Find the general solution to the associated homogeneous equation.

\vspace{0.25cm}

\noindent The auxiliary equation is: $m^2 + 4m-2=0$; using the quadratic equation gives us:\marginnote{Here you are expected to examine the associated homogeneous problem as $u^{\prime \prime}+4u^{\prime}-2u =0$, identify it as constant coefficient and linear, and solve by assuming $u=e^{mx}$ and thus deriving the auxiliary equation shown without further prompting.} 
\begin{align*}
m &= \frac{-4 \pm \sqrt{16 - (4)(1)(-2)}}{2(1)} \\
&= -2 \pm \frac{\sqrt{24}}{2} \\
&= -2 \pm \sqrt{6}
\end{align*}
so $u_c(x) = c_1e^{(-2+\sqrt{6})x}+c_2e^{(-2-\sqrt{6})x}$.

\vspace{3.0cm}
\noindent{\textbf{Step \#2:}} Apply the method of undetermined coefficients to construct a candidate $u_p(x)$.

\vspace{0.25cm}

\noindent Since $g(x)$ is a second-order polynomial, the table tells us $u_p(x)$ is in the general form of a second-order polynomial.
$$u_p(x) = K_2x^2+K_1x+K_0$$
We plug this into the governing equation and this gives us:
\begin{equation*}
2K_2 + 4(2K_2x+K_1) - 2(K_2x^2+K_1x+K_0) = 2x^2-3x+6
\end{equation*}
Now we need to equate the coefficient for each power of $x$:

\begin{table*}[h!]
\begin{tabular}{l r l}
$x^2$:&$-2K_2 $&$= 2$ \\
$x$:& $8K_2 - 2K_1$ &$= -3$ \\
$1$:&$2K_2+4K_1-2K_0$ &$= 6$
\end{tabular}
\end{table*}
Luckily for us, this system of equations is structured such that it can easily be solved.  We see by inspection that $K_2 = 2/-2 = -1$; this can be plugged into the second equation to find $K_1 = -5/2$ and then we can solve the last equation to find that $K_0 = -9$.\marginnote[-4.0cm]{In general you cannot expect this to go so nicely.  What you \emph{can} hope for is that the, in this case, three equations you derive will have a unique solution.  We could re-write the system in the form of a matrix-vector equation:
\begin{equation*}
\begin{bmatrix}
0 & 0 & -2 \\
0 & -2 & 8 \\
-2 & 4 & 2
\end{bmatrix}
\begin{bmatrix}
K_0 \\
K_1 \\
K_2
\end{bmatrix}
= 
\begin{bmatrix}
2 \\
-3 \\
6
\end{bmatrix}
\end{equation*}
If the solution of such a matrix cannot be done by inspection and simple algebra as it was in this case, we could use tools like MATLAB to solve the linear system of equations.  This topic and much more is covered in the numerical methods portion of this text.}

Thus the particular solution is:
\begin{equation*}
u_p(x) = -x^2-\frac{5}{2}x -9
\end{equation*}

\vspace{0.25cm}
\noindent\textbf{Step \#3:} Construct the general solution: $u(x) = u_c(x)+u_p(x)$.

\vspace{0.25cm}

\noindent We now have both the complementary solution and a particular solution.  We form the general solution to the equation by adding them together.
\begin{align*}
u(x) &= u_c(x)+u_p(x) \\
&= c_1e^{(-2+\sqrt{6})x}+c_2e^{(-2-\sqrt{6})x}-x^2-\frac{5}{2}x -9
\end{align*}\marginnote[-1.5cm]{\textbf{Question:} Why, again, do we need the constants $c_1$ and $c_2$?

\vspace{0.5cm}

\noindent\textbf{Answer: }Because we have not yet applied initial/boundary conditions.  If those conditions are provided---two conditions for a 2\textsuperscript{nd}-order problem---then we can resolve the constants.
}

\vspace{0.5cm}

\noindent\textbf{Example:} Solve $u^{\prime \prime}-5u^{\prime}+4u=8e^x$.

\vspace{0.25cm}

\noindent\textbf{Step \#1:} Find the general solution to the associated homogeneous problem.

\vspace{0.25cm}

\noindent The auxiliary equation is $m^2-m+4=0$ the left side of which can easily be factored to give $(m-4)(m-1)=0$; the roots of which are $m_1=4$, $m_2=1$.  The complementary solution is:
\begin{equation*}
u_c(x) = c_1e^{4x}+c_2e^{x}
\end{equation*} 

\vspace{3.0cm}

\noindent\textbf{Step \#2:} Apply the method of undetermined coefficients to construct $u_p(x)$.

\vspace{0.25cm}

\noindent Inspecting Table \ref{tab:method-of-guessing-table} we see that $u_p(x)$ should be of the form $Ae^{x}$.  If that function seems vaguely familiar it may be because $e^x$ is part of the complementary solution. 

\vspace{0.25cm}

\noindent\textbf{Question:} If you plug $Ae^{x}$ into your governing equation, without doing any calculations, what value should you get?

\vspace{0.25cm}

\noindent\textbf{Answer:} You will get zero!  Why? Because $e^{x}$ is one of the two linearly independent solutions to the associated homogeneous problem. 

\vspace{0.25cm}

\noindent\textbf{Question: } What do I do now?

\vspace{0.25cm}

\noindent\textbf{Answer: } Invoke the Modification Rule---this is, after all, the reason why the rule exists---and multiply $u_p$ by $x$.  We now have $u_p(x) = Axe^x$.

\vspace{0.25cm}

\noindent We insert this proposed function for $u_p(x)$ into the equation and we get:
\begin{equation*}
2Ae^x+Axe^x - 5(Ae^x+Axe^x) + 4Axe^x = 8e^x
\end{equation*} 
Combine terms and solve for $A$:
\begin{align*}
2Ae^x-5Ae^x &= 8e^x \\
-3Ae^x &= 8e^x \\
A &= -\frac{8}{3}
\end{align*}
So the particular solution is:
\begin{equation*}
u_p(x) = -\frac{8}{3}xe^x
\end{equation*}

\vspace{0.25cm}
\noindent\textbf{Step \#3:} Construct the general solution: $u(x)=u_c(x)+u_p(x)$.
\marginnote{\textbf{Note:} If any of this seems at all sketchy to you, the good news is that you need not worry if your proposed $u_p(x)$ is any good; you can just plug it into the differential equation and find out!}
\begin{align*}
u(x) &= u_c(x)+u_p(x) \\
&=c_1e^{4x}+c_2e^x - \frac{8}{3}xe^{x}
\end{align*}

\newthought{This last example} illustrates the use of the Sum Rule; it also includes an initial condition so the unique solution to the initial value problem can be found.

\vspace{0.25cm}

\noindent\textbf{Example:} Solve the initial value problem: $u^{\prime \prime}+u=4x+10\sin{x}$ with initial conditions $u(\pi)=0, \ u^{\prime}(\pi)=2$.

\vspace{3.25cm}

\noindent\textbf{Step \#1:} Find the general solution to the associated homogeneous problem.

\vspace{0.25cm}

\noindent The auxiliary equation is: $m^2+1=0$, therefore $m=\pm i$ and $u_c(x)$ can be found as:
\begin{equation*}
u_c(x) = c_1\cos{x}+c_2\sin{x}
\end{equation*}

\vspace{0.25cm}

\noindent\textbf{Step \#2:} Apply the method of undetermined coefficients to construct $u_p(x)$.

\vspace{0.25cm}

\noindent For this problem, $g(x) = 4x+10\sin{x}$ has two terms, so we will construct $u_p(x)$ using one term at a time; $u_{p_1}(x)$ using $4x$ and $u_{p_2}(x)$ using $10\sin{x}$.\marginnote[-1.0cm]{It's the linearity property of $\mathcal{L} = \frac{d^2}{dx}+1$ that makes this possible. If $\mathcal{L}(u_{p_1})=4x$ and $\mathcal{L}(u_{p_2})=10\sin{x}$ then $\mathcal{L}(u_{p_1}+u_{p_2})=4x+10\sin{x}$.}  

\vspace{0.25cm}

\noindent\textbf{Step \#2.a:} Find $u_{p_1}(x)$.

\vspace{0.25cm}

\noindent From Table \ref{tab:method-of-guessing-table}, for $g(x)=4x$, we should select $u_{p_1} = K_1x+K_0$.  Inserting this into the differential equation gives us: $K_1x + K_0 = 4x$.  By inspection we can see that $K_0 = 0$ and $K_1 = 4$ so $u_{p_1}(x) = 4x$.  

\vspace{0.25cm}

\noindent\textbf{Step \#2.b: } Find $u_{p_2}(x)$.

\vspace{0.25cm}

\noindent From Table \ref{tab:method-of-guessing-table}, for $g(x)=10\sin{x}$, we should select $u_{p_2} =  K\cos{x}+M\sin{x}$. Now that we have done this a couple of times we should be on the alert for portions of the complementary solution cropping up in our guesses for $u_p(x)$. We thus immediately see that we need to multiply $u_{p_2}$ by $x$.  If we do this and insert $Kx\cos{x}+Mx\sin{x}$ into the differential equation we get:
\begin{multline*}
\left(-2K-Mx\right)\sin{x}+\left(2M-Kx\right)\cos{x} + \dots \\ Kx\cos{x}+Mx\sin{x} = 10\sin{x}
\end{multline*}

\vspace{0.20cm}

\noindent Matching coefficients for $\sin{x}$ and $\cos{x}$ on both sides of the above equation leads us to conclude that $M=0$ and $-2K = 10$.  Therefore $K = -5$ and $u_{p_2}(x)=-5x\cos{x}$.\marginnote{Again, there is no harm in testing your proposed $u_{p_2}(x)$ to see if it does indeed produce the expected result.}

\vspace{0.20cm}

\noindent\textbf{Step \#3:} Construct the general solution: $u(x)=u_c(x)+u_p(x)$.

\begin{align*}
u(x) &= u_c(x) + u_p(x) \\ 
&= u_c(x) + u_{p_1}(x)+u_{p_2}(x) \\
&= c_1\cos{x}+c_2\sin{x}+4x-5x\cos{x}
\end{align*}

\noindent All that remains is to apply the initial conditions.  

\begin{align*}
u(\pi) &= c_1(-1)+c_2(0)+4\pi -5(\pi)(-1) \\
&=-c_1+9\pi = 0 \\
\Rightarrow &= c_1 = 9\pi
\end{align*}

\vspace{0.1cm}

\noindent Applying the initial condition $u^{\prime}=2$:
\begin{equation*}
u^{\prime}(\pi)=-9\pi(0)+c_2(-1)+4-5(-1)+5\pi(0)=2
\end{equation*}

\vspace{0.1cm}

\noindent Solving for $c_2$ gives us: $c_2 = 7$; folding this into the general solution:

\begin{equation*}
u(x) = 9\pi \cos{x}+7\sin{x}+4x-5x\cos{x}
\end{equation*}
